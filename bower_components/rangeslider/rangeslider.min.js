/*! rangeslider - v0.1.2 | (c) 2014 @andreruffert | MIT license | http://github.com/andreruffert/rangeslider */
!function(a,b,c){"use strict";function d(){var a=c.createElement("input");return a.setAttribute("type","range"),"text"!==a.type}function e(){var a=!1,d=d||{};return("ontouchstart"in b||b.DocumentTouch&&c instanceof d)&&(a=!0),a}function f(a,b){var c=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)}function g(a,c){return c=c||100,function(){if(!a.debouncing){var d=Array.prototype.slice.apply(arguments);a.lastReturnVal=a.apply(b,d),a.debouncing=!0}return clearTimeout(a.debounceTimeout),a.debounceTimeout=setTimeout(function(){a.debouncing=!1},c),a.lastReturnVal}}function h(d,e){if(k)return!1;this.$window=a(b),this.$document=a(c),this.$element=a(d),this.options=a.extend({},l,e),this._defaults=l,this._name=i,this.$range=a('<div class="'+this.options.rangeClass+'" />'),this.$fill=a('<div class="'+this.options.fillClass+'" />'),this.$handle=a('<div class="'+this.options.handleClass+'" />'),this.$base=this.$element.parent("."+this.options.baseClass).prepend(this.$range,this.$fill,this.$handle),this.value=parseInt(this.$element[0].getAttribute("value"))||0,this.min=parseInt(this.$element[0].getAttribute("min"))||0,this.max=parseInt(this.$element[0].getAttribute("max"))||0,this.step=parseInt(this.$element[0].getAttribute("step"))||1,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.handleDown=a.proxy(this.handleDown,this),this.handleMove=a.proxy(this.handleMove,this),this.handleEnd=a.proxy(this.handleEnd,this),this._$element=a('<input type="hidden" />').attr("name",this.$element.attr("name")),this.$element.after(this._$element).remove(),this.$element=this._$element,this.init();var h=this;this.$window.on("resize",g(function(){f(function(){h.init()},300)},20)),this.$document.on(this.options.startEvent,"."+this.options.baseClass,this.handleDown)}var i="rangeslider",j=e(),k=d(),l={baseClass:"rangeslider",rangeClass:"rangeslider__range",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:j?"touchstart":"mousedown",moveEvent:j?"touchmove":"mousemove",endEvent:j?"touchend":"mouseup"};h.prototype.init=function(){this.handleWidth=this.$handle.width(),this.rangeWidth=this.$range[0].offsetWidth,this.maxHandleX=this.rangeWidth-this.handleWidth,this.grabX=this.handleWidth/2,this.position=this.getPositionFromValue(this.value),this.setPosition(this.position)},h.prototype.handleDown=function(a){a.preventDefault(),this.$document.on(this.options.moveEvent,this.handleMove),this.$document.on(this.options.endEvent,this.handleEnd);var b=this.getRelativePosition(this.$base[0],a),c=this.getPositionFromNode(this.$handle[0])-this.getPositionFromNode(this.$base[0]);this.setPosition(b-this.grabX),b>=c&&b<c+this.handleWidth&&(this.grabX=b-c)},h.prototype.handleMove=function(a){a.preventDefault();var b=this.getRelativePosition(this.$base[0],a);this.setPosition(b-this.grabX)},h.prototype.handleEnd=function(a){a.preventDefault(),this.$document.off(this.options.moveEvent,this.handleMove),this.$document.off(this.options.endEvent,this.handleEnd);var b=this.getRelativePosition(this.$base[0],a);this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(b-this.grabX,this.value)},h.prototype.cap=function(a,b,c){return b>a?b:a>c?c:a},h.prototype.setPosition=function(a){var b,c;b=this.cap(a,0,this.maxHandleX),c=this.getValueFromPosition(b),this.step>1&&(c=Math.ceil(c/this.step)*this.step,b=this.getPositionFromValue(c)),b=Math.ceil(b),this.$fill[0].style.width=b+this.handleWidth+"px",this.$handle[0].style.left=b+"px",this.setValue(c),this.position=b,this.value=c,this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(b,c)},h.prototype.getPositionFromNode=function(a){for(var b=0;null!==a;)b+=a.offsetLeft,a=a.offsetParent;return b},h.prototype.getRelativePosition=function(a,b){return(b.pageX||b.originalEvent.changedTouches[0].pageX||0)-this.getPositionFromNode(a)},h.prototype.getPositionFromValue=function(a){var b,c;return b=(a-this.min)/(this.max-this.min)*100,c=b/100*this.maxHandleX},h.prototype.getValueFromPosition=function(a){var b,c;return b=a/this.maxHandleX*100,c=Math.ceil(b/100*(this.max-this.min)+this.min)},h.prototype.setValue=function(a){this.$element.val(a)},a.fn[i]=function(b){return this.each(function(){a.data(this,"plugin_"+i)||a.data(this,"plugin_"+i,new h(this,b))})}}(jQuery,window,document);